{%extends 'goods_info/base.html'%}
{%block head%}
<script>
	function add_cart(gid){
		$.get('/user/islogin/',function(data){
			if(data.isadd){
				$.get('/cart/add/',{'gid':gid},function(data){
				    console.log(gid);
					console.log(data.add);
					if(data.add){
					    alert('添加成功');
					}
					else{
					    alert("添加失败，稍后请重试");
					}
				})
			}
			else{
			   location.href='/user/login/';
			}
		})
	}

</script>

{%endblock head%}
{%block detail%}
	<div class="breadcrumb">
		<a href="#">全部分类</a>
		<span>></span>
		<a href="#">{{t1.ttitle}}</a>
	</div>
{%endblock detail%}
		{%block right%}
		<div class="r_wrap fr clearfix">
			<div class="sort_bar">
				<a href="#" class="active">默认</a>
				<a href="/goods/list{{t1.id}}_gprice_/">价格</a>
				<a href="/goods/list{{t1.id}}_gclick_/">人气</a>
			</div>

			<ul class="goods_type_list clearfix">
				{%for g in list%}
				<li>
					<a href="/goods/{{g.id}}/"><img src="/static/{{g.gpic}}/"></a>
					<h4><a href='/goods/{{g.id}}/'>{{g.gtitle}}</a></h4>
					<div class="operate">
						<span class="prize">￥{{g.gprice}}</span>
						<span class="unit">{{g.gprice}}/{{g.gunit}}</span>
						<a href="javascript:add_cart({{g.id}});" class="add_goods" title="加入购物车"></a>

					</div>
				</li>
				{%endfor%}
			</ul>
			<div class="pagenation">
				{%if list.has_previous%}
				<a href="/goods/list{{t1.id}}_{{t}}_{{list.number|add:-1}}/">上一页</a>
				{%endif%}
				{%if plist.0 > 1%}
				<a href="/goods/list{{t1.id}}_{{t}}_{{list.number|add:-5}}">...</a>
				{%endif%}
				{%for y in plist%}

				{%if list.number == y%}
				<a href="/#" class="active">{{y}}</a>
				{%else%}
				<a href="/goods/list{{t1.id}}_{{t}}_{{y}}/" class="active">{{y}}</a>
				{%endif%}
				{%endfor%}
				{%if plist.4 < list.num_pages%}
				<a href="/goods/list{{t1.id}}_{{t}}_{{list.number|add:5}}">...</a>
				{%endif%}
				{%if list.has_next%}
				<a href="/goods/list{{t1.id}}_{{t}}_{{list.number|add:1}}/">下一页></a>
				{%endif%}
			</div>
		</div>
		{%endblock right%}